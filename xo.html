<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="xo.css">
    <title>Multiplayer game</title>
</head>
<body>
    <h1> Multiplayer X-O </h1>
    <img src="xo.png" style="position: absolute;left:35%;height:400px">
    <button id="b1" onclick="myfunc1()"></button>
    <button id="b2" onclick="myfunc2()"></button>
    <button id="b3" onclick="myfunc3()"></button>
    <button id="b4" onclick="myfunc4()"></button>
    <button id="b5" onclick="myfunc5()"></button>
    <button id="b6" onclick="myfunc6()"></button>
    <button id="b7" onclick="myfunc7()"></button>
    <button id="b8" onclick="myfunc8()"></button>
    <button id="b9" onclick="myfunc9()"></button>
    <button id="reset">Play Again</button>
    <script>
        /*
        BOARD = {
            "1": "",
            "2": "",
            "3": "",
            "4": "",
            "5": "",
            "6": "",
            "7": "",
            "8": "",
            "9": "",
        }
        X_POS = set()
        O_POS = set()
        GAMEOVER = False
        */
        function myfunc1() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 1}))
        }
        function myfunc2() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 2}))
        }
        function myfunc3() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 3}))
        }
        function myfunc4() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 4}))
        }
        function myfunc5() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 5}))
        }
        function myfunc6() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 6}))
        }
        function myfunc7() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 7}))
        }
        function myfunc8() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 8}))
        }
        function myfunc9() {
            websocket.send(JSON.stringify({action: "set cell", player: player, pos: 9}))
        }
            
        var websocket = new WebSocket("ws://127.0.0.1/")
        var playercount = 0
        var gameover = false
        var board = null

        websocket.onopen = function (e) {
                console.log("Connected to server...")
            }


        websocket.onmessage = function (event) {
            data = JSON.parse(event.data);
            console.log(data)
            switch (data.type) {
                case 'state':
                // {"type": "state", "gameover": GAMEOVER, "board": BOARD}
                    gameover = data.gameover
                    board = JSON.parse(data.board)
                    console.log(board)
                    break;
                case 'playercount':
                    playercount = data.count.toString()
                    break;
                case 'player':
                    player = data.player
                    console.log(player)
                    break;
                default:
                    console.error(
                        "unsupported event", data);
            }
        };

        // websocket.send(JSON.stringify({action: "set cell", player: player, pos: "num"}))
    </script>

</body>
</html>